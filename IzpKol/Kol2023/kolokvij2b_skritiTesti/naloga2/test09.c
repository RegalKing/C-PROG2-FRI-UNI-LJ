#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>

#include "naloga2.h"

#define _M 10001
int _P[] = {8378, 8042, 8143, 8402, 6084, 4448, 1651, 5646, 5004, 6415, 3201, 8891, 6024, 7657, 3377, 7767, 421, 2123, 850, 1701, 5339, 3665, 6593, 8872, 7229, 1918, 7117, 1158, 2239, 8878, 137, 1271, 6641, 2589, 4909, 9970, 1875, 9840, 1466, 7682, 8943, 1558, 3488, 3773, 2816, 2500, 5436, 4132, 5741, 977, 2231, 451, 6217, 3162, 4717, 4097, 8354, 8375, 6029, 5585, 7076, 2663, 2762, 3173, 1170, 8686, 1402, 2931, 695, 3546, 4605, 4072, 7232, 6678, 9775, 2178, 6113, 5153, 7875, 677, 2315, 41, 5641, 3462, 216, 8812, 476, 7426, 6517, 1322, 6112, 2822, 172, 3008, 9839, 3485, 2933, 9698, 4873, 5656, 9694, 2875, 4502, 8938, 9561, 8126, 5528, 8135, 2137, 7025, 807, 5499, 898, 4032, 2452, 99, 4681, 866, 6735, 9990, 9707, 4976, 7515, 3817, 8427, 2259, 8138, 5588, 912, 2542, 7882, 5994, 6702, 1109, 7486, 2764, 7150, 6785, 9750, 1845, 5293, 1805, 5088, 2213, 8551, 3189, 1386, 1552, 4761, 950, 381, 9417, 3234, 8141, 1228, 7430, 5346, 2651, 3647, 732, 3445, 112, 8977, 4650, 7489, 5414, 7386, 4075, 7612, 7553, 2419, 666, 7934, 4355, 8764, 6068, 5260, 2089, 43, 2620, 4419, 5323, 8500, 3540, 367, 231, 5949, 9719, 181, 4995, 1556, 8008, 4541, 1292, 8794, 987, 9501, 1789, 7991, 3057, 4557, 5841, 6788, 2061, 3459, 3859, 9800, 2911, 5045, 9957, 7371, 1835, 2098, 5042, 8887, 9737, 3832, 5120, 936, 1367, 2510, 2153, 8667, 7038, 4370, 5859, 2774, 904, 9806, 2880, 154, 6015, 9674, 2005, 5623, 8504, 4194, 220, 5795, 3815, 7220, 600, 6553, 5737, 4100, 6961, 4077, 3207, 8259, 3593, 8351, 7360, 4298, 725, 4312, 6685, 205, 8312, 239, 1249, 941, 562, 2550, 6732, 4707, 1625, 4506, 8250, 3138, 2106, 7775, 4118, 8658, 822, 4857, 5727, 2119, 8012, 422, 1884, 3578, 7442, 5644, 6529, 74, 8260, 5173, 5857, 6556, 4946, 2766, 7384, 500, 8003, 4725, 7667, 7095, 4045, 9574, 488, 7586, 6435, 7793, 3316, 558, 2847, 7197, 270, 3924, 2379, 7250, 9976, 6692, 4284, 1589, 3942, 2874, 6652, 3509, 9907, 2729, 7297, 24, 3868, 8721, 7989, 6239, 8002, 811, 2565, 6816, 4540, 5453, 7389, 4918, 5167, 9807, 5132, 3819, 5522, 4613, 5531, 4161, 3282, 9611, 5137, 6504, 9908, 9533, 6846, 4792, 7514, 5998, 1163, 6008, 5041, 2881, 3718, 8416, 2491, 7026, 4301, 8359, 3075, 6794, 7571, 8947, 8918, 284, 871, 682, 3369, 8423, 8655, 5009, 6965, 8554, 3734, 8266, 1446, 905, 4160, 2643, 6740, 6892, 7028, 7323, 6202, 3151, 8642, 7552, 2609, 648, 7749, 5851, 204, 5030, 2892, 1513, 2051, 2601, 7610, 9953, 6083, 6471, 329, 45, 2007, 7186, 1492, 3384, 6865, 9151, 9600, 2909, 3496, 6452, 7860, 6649, 3043, 8458, 4710, 8509, 9773, 408, 7496, 1620, 8799, 2497, 5001, 2260, 2356, 4017, 2240, 7827, 5263, 734, 3557, 3693, 3959, 5696, 9763, 843, 6179, 1431, 9862, 6333, 6993, 3098, 3215, 1705, 3610, 2373, 399, 4808, 7654, 9885, 5342, 8118, 7943, 4959, 4150, 6149, 3393, 3677, 6642, 6665, 4691, 1506, 6482, 3835, 4874, 9053, 2268, 1434, 4138, 5978, 2191, 2604, 8079, 2715, 8561, 6752, 7907, 9538, 3191, 4601, 1548, 213, 6080, 8314, 3452, 4279, 6093, 8910, 7167, 8480, 970, 7221, 6909, 683, 9289, 140, 3353, 8124, 3656, 3305, 7107, 7376, 6469, 5033, 5439, 9159, 9025, 3159, 7884, 6723, 3555, 6067, 130, 3388, 9462, 6485, 8932, 6602, 5362, 7983, 6698, 2295, 1053, 9894, 1658, 202, 6085, 1218, 361, 9092, 7637, 9359, 6744, 3480, 4644, 3217, 4796, 5660, 1237, 7664, 8217, 4544, 6505, 8756, 9948, 6552, 6136, 8307, 6820, 3468, 5552, 4758, 2437, 8187, 3643, 9647, 9315, 1398, 1037, 6102, 5959, 5765, 4084, 5396, 8411, 3932, 1693, 4877, 1983, 6632, 3147, 4689, 2745, 160, 3208, 7181, 7619, 1403, 4158, 502, 2181, 1316, 5245, 4108, 8920, 4433, 5007, 7114, 37, 3248, 3166, 1112, 4779, 8674, 2755, 6405, 8556, 9047, 7523, 7769, 4341, 3926, 9342, 2487, 3167, 3531, 2725, 4033, 7309, 5733, 243, 4082, 2803, 863, 9767, 5354, 8470, 8940, 1221, 9605, 7234, 2122, 155, 6297, 650, 111, 5986, 3701, 1735, 4957, 3720, 4485, 6628, 2110, 4186, 3157, 8548, 4188, 9307, 4641, 6118, 8767, 7483, 4924, 6073, 4046, 6326, 3535, 98, 4487, 4059, 848, 7416, 27, 4292, 8231, 9329, 4814, 7698, 8555, 5190, 7817, 6737, 8577, 8678, 6964, 8148, 2372, 4170, 4167, 9972, 9899, 8572, 7287, 6304, 2733, 8220, 3015, 1885, 6403, 4911, 4473, 4359, 4109, 9219, 4626, 2553, 1859, 697, 5534, 3356, 3751, 2467, 2126, 9793, 7933, 3289, 8892, 7184, 5048, 8475, 4498, 4971, 9104, 3814, 5574, 2037, 6722, 2551, 7022, 5619, 9014, 2975, 3001, 6610, 8689, 9138, 3729, 9264, 1437, 6216, 9887, 221, 6817, 8822, 9337, 103, 3094, 7255, 3770, 3296, 6777, 6448, 4242, 5718, 9895, 2966, 659, 8719, 5661, 8199, 7290, 7504, 5288, 8256, 2386, 6381, 9045, 3562, 7414, 8589, 2362, 2684, 7861, 4420, 2169, 9160, 9049, 9569, 1862, 9604, 8459, 9278, 5142, 5982, 4428, 3156, 7962, 6417, 9445, 5943, 5542, 6863, 2104, 2670, 6426, 9181, 6867, 7455, 5833, 4820, 1692, 9870, 4671, 6995, 9193, 7898, 7135, 2427, 5049, 7081, 8832, 7222, 8868, 540, 2918, 9572, 97, 84, 5318, 3621, 2885, 5082, 1950, 3976, 9036, 4785, 1117, 2140, 9281, 7966, 1435, 7467, 9909, 886, 9817, 7731, 1459, 1619, 7047, 2531, 5691, 5530, 6870, 9944, 8172, 9400, 3267, 4461, 88, 4122, 8027, 2739, 7029, 5174, 6635, 704, 4490, 8897, 7807, 1678, 7006, 9206, 5755, 976, 8130, 4443, 6542, 2835, 2704, 2908, 6769, 4951, 6411, 1720, 1320, 634, 200, 4367, 1645, 8844, 4938, 5983, 7056, 2052, 3021, 2471, 9355, 5455, 26, 2709, 3329, 1016, 8904, 9585, 1408, 2999, 7456, 9931, 5631, 9008, 1795, 8283, 4816, 626, 2545, 5834, 6416, 544, 6263, 2204, 3491, 2214, 4314, 1344, 7219, 4352, 6311, 6515, 3613, 7825, 7331, 8701, 9965, 2035, 8883, 9061, 5683, 4281, 1775, 1975, 4628, 6082, 8323, 6069, 988, 8641, 4381, 7756, 9676, 7228, 6356, 525, 4494, 8194, 136, 8836, 1646, 4914, 5639, 8103, 6526, 9316, 5448, 5140, 6537, 418, 54, 3334, 7068, 9622, 4334, 5538, 450, 4016, 6534, 6097, 6372, 9610, 298, 8774, 350, 235, 2867, 7263, 3093, 5901, 7284, 2887, 5609, 3501, 5434, 9248, 2021, 3566, 4966, 4678, 2917, 9113, 7696, 1284, 5969, 6039, 2955, 9733, 5196, 5271, 3031, 6047, 441, 5920, 1286, 7655, 9194, 9664, 8830, 1797, 5507, 633, 8631, 4111, 9859, 4348};
int _RAZREDI[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
int _ST_VOZLISC = sizeof(_RAZREDI) / sizeof(_RAZREDI[0]);
#define  _ST_RAZREDOV (sizeof(_P) / sizeof(_P[0]))
Vozlisce* _I2V[_ST_RAZREDOV];
bool _POBRISAN[_M];

Vozlisce* _ustvari() {
    Vozlisce* zacetek = NULL;
    Vozlisce* prej = NULL;
    int zadnjiRazred = -1;

    for (int i = 0; i < _ST_VOZLISC; i++) {
        Vozlisce* v = calloc(1, sizeof(Vozlisce));
        int r = _RAZREDI[i];
        if (r > zadnjiRazred) {
            zadnjiRazred = r;
            v->p = malloc(sizeof(int));
            *v->p = _P[r];
            _I2V[r] = v;
        } else {
            v->p = _I2V[r]->p;
        }
        if (i == 0) {
            zacetek = v;
        } else {
            prej->naslednje = v;
        }
        prej = v;
    }
    return zacetek;
}

void _izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* w = v;
    while (w != NULL) {
        printf("%s%d", (w == v ? "" : ", "), *w->p);
        w = w->naslednje;
    }
    printf("]\n");
}

void _preveriIstovetnost(Vozlisce* v) {
    int i = 0;
    for (Vozlisce* w = v; w != NULL; w = w->naslednje) {
        printf("%d", w == _I2V[i]);
        i++;
    }
    printf("\n");
}

void _pocisti(Vozlisce* v) {
    if (v != NULL) {
        _pocisti(v->naslednje);
        int pp = *v->p;
        if (!_POBRISAN[pp]) {
            free(v->p);
            v->p = NULL;
            _POBRISAN[pp] = true;
        }
        free(v);
    }
}

int main() {
    Vozlisce* v = _ustvari();

    printf("Prej:\n");
    _izpisi(v);
    printf("\n");

    izlociDuplikate(v);

    printf("Potem:\n");
    _izpisi(v);
    printf("\n");

    printf("Istovetnost ohranjenih vozlisc:\n");
    _preveriIstovetnost(v);

    _pocisti(v);

    return 0;
}
