#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>

#include "naloga2.h"

#define _M 10001
int _P[] = {6750, 3429, 5808, 2727, 4764, 4021, 7469, 4336, 53, 9556, 8673, 9564, 6221, 4335, 1460, 2970, 8499, 3453, 5169, 3806, 375, 5189, 5298, 7340, 5382, 2883, 9973, 5455, 1402, 1742, 6189, 4765, 888, 4679, 5505, 392, 3609, 6480, 8026, 3038, 4011, 6403, 5237, 9639, 5422, 9139, 7387, 1832, 122, 8582, 1758, 4214, 3869, 4065, 8760, 4465, 6452, 7749, 1853, 3747, 3632, 1469, 6528, 6449, 1963, 2835, 8217, 5833, 4614, 3664, 7751, 9105, 2535, 9210, 7510, 6306, 7545, 2, 9375, 3777, 7491, 7859, 976, 408, 8302, 3624, 935, 1228, 6275, 4527, 5843, 4394, 8085, 8403, 7001, 3519, 3200, 3219, 2761, 346, 9760, 4745, 9809, 7607, 599, 9626, 5221, 6927, 6571, 1691, 113, 8066, 3417, 3447, 4731, 1927, 3696, 7990, 425, 5271, 3196, 75, 4967, 3115, 9885, 2876, 103, 8771, 4054, 1315, 2433, 8312, 7127, 1389, 4597, 5197, 4627, 966, 944, 9440, 4393, 5544, 820, 16, 1199, 5713, 4880, 8650, 7996, 2250, 1362, 9605, 3424, 9830, 1755, 3322, 1716, 6384, 4485, 219, 1997, 2340, 8054, 8038, 1916, 4803, 4723, 5396, 3873, 8064, 3842, 6817, 3999, 2539, 4572, 8635, 5941, 6245, 8253, 2753, 4017, 2487, 5051, 6416, 110, 6347, 5852, 7374, 3975, 8577, 2253, 4657, 9981, 5127, 8270, 4715, 8873, 3342, 4506, 8333, 4310, 679, 1511, 7203, 8502, 8351, 4683, 7444, 4176, 8414, 8007, 8841, 9107, 8250, 3535, 5821, 6003, 6143, 9946, 5581, 153, 6090, 2425, 6226, 775, 3260, 62, 3887, 5634, 8694, 4051, 5583, 4678, 1752, 1019, 93, 76, 8852, 3758, 707, 4145, 4088, 4971, 8768, 7076, 6725, 6340, 3047, 697, 3908, 3646, 6276, 5514, 4642, 6467, 1395, 3848, 4440, 9005, 1337, 3231, 8955, 5441, 4623, 3701, 6483, 5416, 894, 2628, 1818, 1805, 4871, 9761, 4788, 1945, 3165, 7408, 5461, 1481, 2270, 125, 5552, 9394, 546, 4118, 4964, 1141, 3805, 9894, 9514, 766, 3410, 7371, 5152, 6061, 2959, 5420, 7548, 4272, 5337, 3861, 3677, 890, 1207, 9780, 8643, 3311, 8188, 5027, 5971, 7796, 2184, 3582, 6004, 7752, 8013, 1800, 7525, 248, 4110, 1378, 9277, 627, 6127, 4649, 201, 1219, 870, 6533, 365, 649, 2480, 2737, 9058, 3550, 2482, 3851, 1445, 9978, 3438, 5919, 2955, 6950, 9993, 6271, 1143, 948, 6628, 2116, 7554, 1085, 4493, 7027, 5637, 2086, 4998, 9788, 2393, 7106, 3383, 2432, 9614, 5440, 2412, 3952, 1021, 4819, 5092, 2160, 5585, 3718, 4097, 8983, 7151, 9218, 1780, 779, 5398, 3895, 4858, 843, 5503, 6525, 6487, 4954, 4276, 6580, 7277, 7526, 1428, 1039, 7849, 3832, 5285, 2205, 6063, 3809, 8837, 2329, 1383, 3923, 8599, 4390, 9498, 1506, 7944, 7687, 3095, 8352, 9200, 7154, 3533, 5875, 8024, 9061, 9039, 8112, 5009, 9054, 1120, 543, 7963, 4417, 7030, 5185, 5029, 6118, 1013, 4151, 4002, 3563, 2382, 7123, 828, 3918, 3544, 965, 6633, 6440, 5266, 7677, 6928, 2097, 9328, 8608, 808, 7579, 5960, 6254, 2476, 5565, 5204, 7048, 7457, 2526, 4090, 2355, 1179, 3748, 1454, 2948, 8759, 9001, 5754, 127, 4586, 5584, 9443, 7891, 1417, 5747, 7690, 5261, 3709, 8016, 4830, 7329, 9214, 8363, 6230, 5541, 5304, 1686, 3308, 4203, 8426, 3599, 7962, 1981, 8454, 5660, 2951, 1382, 228, 7068, 9093, 6212, 2067, 2701, 863, 4180, 1190, 6160, 3472, 8954, 3059, 4147, 1235, 6904, 3812, 974, 9578, 1638, 4681, 1136, 956, 432, 4183, 4023, 7017, 1097, 3408, 5349, 9366, 254, 681, 1220, 664, 853, 8353, 4, 9799, 8812, 7555, 2071, 4521, 3539, 4866, 1164, 8208, 895, 7045, 9415, 5751, 9367, 9853, 5767, 8934, 3972, 8653, 1971, 3501, 2384, 2501, 6683, 6170, 969, 3217, 4474, 6603, 8607, 2716, 2230, 6797, 5876, 1842, 6346, 18, 5986, 7241, 8987, 8142, 6636, 9681, 6882, 4869, 7938, 8709, 5709, 8027, 6719, 5912, 7362, 2528, 2912, 6809, 6685, 5241, 457, 2898, 9773, 2767, 6131, 1248, 6733, 5485, 7302, 4444, 9349, 9216, 570, 3743, 1901, 9369, 931, 4916, 9399, 2405, 6984, 5108, 7669, 2741, 9611, 2858, 3117, 4265, 993, 3763, 4735, 7933, 4844, 6690, 7399, 5638, 5268, 5482, 8389, 3693, 2712, 3508, 8097, 3086, 1928, 2017, 6043, 2871, 2857, 390, 9621, 4433, 3378, 3798, 722, 5885, 6553, 4675, 4232, 7503, 1484, 7804, 3120, 4660, 6740, 9337, 1650, 1490, 2397, 3783, 3867, 7291, 386, 6258, 7487, 7201, 9194, 837, 9465, 7438, 5205, 3313, 7461, 8405, 3155, 1773, 3349, 4937, 9403, 3068, 827, 2902, 233, 4096, 1244, 6736, 1359, 7102, 8698, 2777, 7421, 5883, 9960, 4989, 4742, 5773, 4285, 4103, 3858, 3263, 4718, 9052, 3218, 7369, 1334, 5871, 6668, 941, 3856, 3506, 2550, 5855, 1354, 4806, 2750, 2140, 5956, 2635, 6015, 1754, 7235, 3865, 7331, 4985, 4986, 8063, 8034, 1111, 1873, 5643, 6110, 982, 9386, 3681, 8497, 4395, 5163, 6423, 3406, 8271, 6972, 4044, 3366, 2168, 8696, 448, 1748, 6937, 1434, 554, 9685, 5674, 1869, 1365, 4870, 4073, 8447, 1430, 9940, 8458, 6973, 7113, 3224, 420, 1309, 4131, 6729, 7603, 1485, 4294, 7952, 7926, 3198, 1851, 231, 7964, 7464, 8005, 8311, 2001, 3720, 4960, 213, 855, 367, 6439, 1941, 978, 5702, 7142, 5404, 7481, 5513, 1414, 2448, 2029, 7743, 2773, 5911, 3183, 7682, 3384, 4522, 4066, 7542, 2726, 8274, 7505, 6194, 3837, 6741, 1978, 1487, 5567, 8640, 2523, 3171, 7937, 9787, 9540, 1632, 5899, 3505, 1280, 5593, 9752, 9335, 8853, 8060, 9547, 537, 9850, 4102, 4666, 2472, 6028, 7750, 9033, 7768, 3917, 5260, 4144, 8050, 6635, 2621, 340, 5574, 1862, 9798, 6084, 5283, 6759, 6017, 2437, 9589, 7219, 930, 8598, 1811, 6391, 9618, 5065, 3793, 9095, 9099, 3074, 333, 7294, 411, 5537, 5447, 7319, 8314, 33, 4659, 443, 2237, 915, 6856, 7157, 5236, 6105, 3175, 2117, 6672, 8774, 4690, 1224, 720, 3688, 60, 8113, 5385, 7792, 3267, 6843, 2466, 5501, 9155, 8354, 8805, 3203, 4340, 4204, 6876, 1437, 8956, 5609, 8290, 5928, 1824, 1174, 587, 9182, 5698, 1760, 6893, 376, 9293, 7635, 5881, 4573, 2759, 1479, 6313, 4784, 9926, 5460, 7134, 652, 3461, 7618, 7126, 6297, 1681, 4234, 743, 3098, 3899, 9806, 7002, 9904, 9358, 4220, 4197, 7627, 4341, 9320, 9390, 2669, 2906, 2891, 3421, 3435, 2570, 72, 5370, 9662, 6638, 1770, 8200, 9895, 791, 9132, 6992, 9116, 9391, 9102, 6735, 2645, 4492, 2014, 8448, 4763, 6745, 1682, 5949, 6738, 2890, 9776, 4018, 9450, 7163, 7245, 250, 7871, 7864, 1664, 2837, 422, 702, 7474, 84, 8501, 9543, 2057, 4284, 3644, 2648, 1749, 180, 3651};
int _RAZREDI[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
int _ST_VOZLISC = sizeof(_RAZREDI) / sizeof(_RAZREDI[0]);
#define  _ST_RAZREDOV (sizeof(_P) / sizeof(_P[0]))
Vozlisce* _I2V[_ST_RAZREDOV];
bool _POBRISAN[_M];

Vozlisce* _ustvari() {
    Vozlisce* zacetek = NULL;
    Vozlisce* prej = NULL;
    int zadnjiRazred = -1;

    for (int i = 0; i < _ST_VOZLISC; i++) {
        Vozlisce* v = calloc(1, sizeof(Vozlisce));
        int r = _RAZREDI[i];
        if (r > zadnjiRazred) {
            zadnjiRazred = r;
            v->p = malloc(sizeof(int));
            *v->p = _P[r];
            _I2V[r] = v;
        } else {
            v->p = _I2V[r]->p;
        }
        if (i == 0) {
            zacetek = v;
        } else {
            prej->naslednje = v;
        }
        prej = v;
    }
    return zacetek;
}

void _izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* w = v;
    while (w != NULL) {
        printf("%s%d", (w == v ? "" : ", "), *w->p);
        w = w->naslednje;
    }
    printf("]\n");
}

void _preveriIstovetnost(Vozlisce* v) {
    int i = 0;
    for (Vozlisce* w = v; w != NULL; w = w->naslednje) {
        printf("%d", w == _I2V[i]);
        i++;
    }
    printf("\n");
}

void _pocisti(Vozlisce* v) {
    if (v != NULL) {
        _pocisti(v->naslednje);
        int pp = *v->p;
        if (!_POBRISAN[pp]) {
            free(v->p);
            v->p = NULL;
            _POBRISAN[pp] = true;
        }
        free(v);
    }
}

int main() {
    Vozlisce* v = _ustvari();

    printf("Prej:\n");
    _izpisi(v);
    printf("\n");

    izlociDuplikate(v);

    printf("Potem:\n");
    _izpisi(v);
    printf("\n");

    printf("Istovetnost ohranjenih vozlisc:\n");
    _preveriIstovetnost(v);

    _pocisti(v);

    return 0;
}
