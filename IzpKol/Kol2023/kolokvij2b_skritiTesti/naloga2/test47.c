#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>

#include "naloga2.h"

#define _M 10001
int _P[] = {5433, 4788, 9617, 5455, 1085, 749, 2973, 5807, 7627, 116, 2370, 6045, 1710, 8106, 8348, 7065, 8509, 7118, 5392, 5336, 7362, 6156, 1611, 1147, 8527, 241, 3038, 4288, 5665, 5294, 8788, 4061, 4506, 5641, 3763, 8023, 5107, 8756, 542, 5965, 859, 3307, 3061, 3327, 6263, 1806, 7916, 8361, 611, 4710, 8903, 4876, 8615, 9887, 5502, 9624, 4465, 6137, 11, 7616, 9090, 3575, 5687, 2408, 8080, 4911, 7638, 7044, 6180, 7205, 8754, 5381, 3497, 457, 452, 5367, 7193, 454, 768, 5532, 9030, 5808, 85, 7968, 1022, 9383, 4779, 823, 1966, 215, 922, 5792, 7176, 5692, 5960, 5572, 9140, 7695, 7589, 2823, 3888, 1610, 3878, 3558, 1977, 7670, 2556, 222, 6795, 934, 9494, 6978, 7758, 9682, 9360, 2571, 5840, 1553, 7463, 501, 7104, 6929, 8828, 5163, 326, 7756, 4885, 4313, 5511, 7053, 4521, 4358, 9683, 188, 3353, 336, 8824, 6101, 1457, 6312, 8758, 1260, 6839, 7197, 5579, 3906, 5076, 7548, 3237, 1036, 6464, 2620, 7330, 9893, 8881, 6107, 7068, 1349, 9335, 6392, 1621, 3868, 1707, 187, 6404, 6091, 5440, 9824, 7761, 5712, 2000, 5492, 2260, 6888, 4899, 4075, 8671, 4793, 3175, 444, 2333, 6735, 3510, 6849, 4360, 4977, 3668, 3743, 2168, 907, 4109, 7928, 2128, 9316, 8749, 4633, 2466, 5520, 591, 5351, 6808, 4008, 2959, 7673, 79, 5448, 6575, 3706, 9613, 6810, 738, 6729, 9491, 2533, 2711, 3245, 2582, 3164, 4270, 1039, 4143, 973, 7611, 6787, 6672, 4527, 7710, 3534, 4173, 650, 4921, 6302, 863, 7381, 2154, 4782, 9436, 64, 9732, 1627, 3708, 4005, 773, 1171, 4803, 9768, 8770, 1527, 733, 3209, 3937, 5708, 4948, 5263, 6642, 5533, 3054, 6991, 2767, 8980, 2729, 7452, 2605, 2519, 5240, 3756, 8699, 6095, 7533, 2028, 6653, 1706, 9109, 127, 1780, 9190, 6079, 5838, 6899, 7926, 3386, 9665, 2915, 2259, 9918, 8747, 5982, 2604, 5385, 8786, 3667, 5075, 1932, 4919, 5806, 7600, 101, 660, 8397, 9832, 2753, 5341, 2304, 220, 746, 6955, 9967, 1568, 2774, 8264, 9471, 2076, 7736, 4931, 832, 758, 7472, 7328, 3015, 4220, 6340, 8830, 3190, 410, 6597, 9301, 9772, 1599, 1725, 7842, 8099, 340, 865, 3826, 3877, 5835, 9010, 3185, 3041, 8930, 960, 8238, 380, 8241, 8482, 1733, 6320, 5588, 493, 6580, 8955, 8706, 9119, 2864, 2762, 748, 915, 1408, 9292, 3049, 5726, 944, 633, 5762, 6461, 7876, 8995, 5925, 3775, 919, 5225, 6965, 4157, 5939, 6569, 2364, 8595, 5042, 9789, 3649, 6431, 9159, 4444, 6256, 3224, 332, 5897, 1970, 3368, 884, 4875, 5396, 8031, 3900, 8402, 2448, 3158, 3475, 9432, 792, 3584, 4272, 365, 9251, 5303, 9022, 3603, 9717, 2775, 1411, 7422, 9225, 2563, 5722, 3431, 7894, 6454, 6295, 6997, 5014, 4401, 4226, 6776, 6333, 6229, 1910, 1410, 8636, 2678, 4251, 7813, 9695, 506, 3145, 1854, 8373, 767, 5371, 8419, 5480, 6946, 9963, 1026, 1834, 9478, 2140, 7958, 413, 7861, 5302, 3319, 5984, 1015, 2493, 2178, 4695, 3170, 3186, 5800, 1497, 7646, 4169, 867, 4400, 9627, 3891, 2765, 2752, 545, 743, 745, 9393, 4684, 570, 6140, 156, 2566, 2314, 154, 9733, 5411, 4484, 7437, 4954, 1387, 7025, 6086, 8516, 7881, 9771, 2726, 7767, 1429, 9259, 6641, 2832, 8217, 5515, 8498, 3032, 6401, 6752, 931, 3563, 8624, 8390, 8580, 8211, 2547, 5911, 8144, 7738, 2411, 1919, 8325, 9112, 8530, 8941, 8832, 781, 2804, 7562, 5902, 5850, 3491, 2418, 5323, 7202, 7644, 8681, 6844, 7660, 1885, 9679, 2700, 7641, 1256, 8859, 2554, 932, 9736, 2283, 147, 3854, 7933, 1810, 2786, 923, 7414, 6230, 705, 2163, 8133, 5362, 9712, 9693, 5171, 6786, 2217, 657, 2318, 8381, 1823, 546, 5953, 292, 812, 5159, 9544, 5996, 2149, 9216, 386, 6663, 4246, 6969, 324, 560, 5287, 7067, 367, 5355, 5637, 5447, 1370, 2695, 9971, 5924, 5397, 5309, 2715, 1766, 2080, 8436, 7155, 8761, 9387, 1332, 5917, 4264, 9770, 9652, 7568, 802, 8330, 279, 4473, 2984, 9823, 4959, 1887, 4680, 7322, 6536, 7273, 7972, 8465, 8969, 8120, 1719, 1095, 3642, 74, 2830, 589, 2570, 8933, 7115, 6636, 1436, 8108, 3526, 9487, 8327, 1841, 3028, 5793, 7501, 533, 4260, 6275, 655, 3044, 4492, 8766, 563, 4653, 1501, 5320, 4090, 893, 9320, 9928, 4772, 7151, 5420, 6135, 8240, 8711, 2721, 5090, 1945, 5768, 9204, 1003, 7720, 5845, 5128, 8810, 3952, 7128, 2385, 346, 3860, 9760, 9042, 9195, 4861, 1671, 5774, 6210, 4052, 9952, 9524, 217, 7687, 4725, 7566, 9380, 7744, 4126, 2022, 7773, 6233, 5219, 7041, 5205, 7532, 5695, 1737, 1570, 9194, 1631, 1109, 4665, 9604, 4002, 3005, 1722, 8410, 4244, 9716, 4488, 3174, 2111, 6368, 1131, 8072, 5645, 2215, 3124, 6678, 4544, 429, 3797, 5363, 8416, 2196, 2911, 1138, 6269, 7733, 8948, 373, 6296, 3270, 2766, 1247, 470, 8651, 5565, 4608, 2285, 5034, 2325, 4774, 953, 967, 635, 9955, 4190, 9011, 482, 9890, 9929, 7717, 3505, 9239, 7058, 6747, 1001, 3144, 2734, 1119, 3920, 9541, 3725, 6218, 5538, 1647, 3338, 4238, 3488, 1475, 662, 1801, 6248, 9719, 1743, 8934, 6870, 5100, 509, 6549, 5675, 5204, 2691, 8597, 7790, 6948, 9689, 9818, 3098, 5764, 9625, 6586, 8411, 2597, 4597, 3994, 4810, 3311, 1279, 8641, 1503, 2293, 146, 5704, 2434, 6860, 3616, 7358, 6882, 1261, 213, 2136, 4053, 5318, 7402, 7016, 8799, 7696, 9602, 631, 7440, 9573, 7239, 6635, 5156, 1217, 5453, 2562, 2476, 5061, 8255, 8974, 1905, 3495, 8814, 3538, 5998, 3036, 9913, 1372, 9290, 9511, 1968, 5218, 2047, 9413, 3897, 3391, 1197, 9095, 3866, 2026, 5826, 5082, 382, 3337, 315, 886, 621, 8349, 2141, 8876, 5162, 7260, 5861, 999, 9306, 6145, 321, 5478, 3612, 6477, 9616, 4917, 1061, 8407, 9883, 2179, 8547, 2222, 6902, 3014, 7385, 8517, 9254, 6178, 8166, 310, 971, 2257, 3021, 4822, 8289, 4443, 1832, 186, 8185, 6246, 6907, 7023, 6281, 1912, 8733, 5836, 9831, 5267, 155, 675, 17, 9440, 5343, 8075, 4652, 7681, 4130, 432, 4101, 4821, 1554, 338, 5606, 3913, 5856, 8066, 3519, 5131, 8251, 6688};
int _RAZREDI[] = {0, 0, 0, 1, 2, 0, 1, 3, 4, 0, 5, 6, 7, 8, 9, 4, 10, 11, 12, 1, 13, 10, 14, 0, 15, 16, 17, 18, 19, 1, 20, 21, 22, 23, 19, 24, 25, 26, 10, 27, 28, 21, 29, 26, 0, 30, 17, 31, 22, 32, 33, 34, 35, 10, 9, 36, 37, 38, 15, 33, 39, 1, 40, 41, 33, 42, 16, 43, 44, 45, 46, 47, 48, 49, 50, 33, 51, 52, 0, 3, 53, 54, 55, 56, 35, 57, 58, 59, 60, 56, 61, 61, 62, 63, 29, 64, 38, 10, 65, 66, 67, 68, 69, 70, 42, 71, 72, 73, 12, 0, 74, 29, 75, 76, 54, 19, 9, 77, 78, 78, 76, 79, 2, 68, 11, 80, 34, 81, 30, 17, 82, 83, 1, 10, 84, 19, 85, 86, 1, 65, 0, 33, 87, 12, 9, 88, 41, 22, 55, 89, 90, 62, 29, 91, 92, 93, 94, 95, 96, 97, 0, 2, 98, 34, 33, 99, 100, 101, 61, 102, 103, 73, 29, 104, 105, 106, 107, 19, 9, 73, 13, 108, 109, 110, 57, 111, 112, 21, 113, 114, 1, 115, 116, 117, 118, 44, 119, 120, 121, 122, 123, 124, 31, 125, 79, 76, 122, 126, 127, 128, 129, 104, 130, 131, 132, 133, 134, 125, 135, 67, 136, 29, 137, 0, 118, 26, 69, 138, 76, 139, 140, 141, 142, 143, 49, 42, 23, 144, 113, 145, 46, 146, 95, 127, 147, 148, 109, 149, 29, 46, 142, 0, 16, 150, 97, 29, 151, 152, 153, 44, 154, 155, 156, 73, 157, 77, 158, 159, 160, 161, 77, 162, 163, 164, 33, 165, 166, 142, 23, 16, 167, 168, 169, 12, 170, 171, 172, 173, 174, 29, 175, 73, 176, 131, 29, 0, 165, 127, 68, 177, 178, 145, 73, 179, 180, 181, 182, 183, 184, 17, 185, 186, 187, 188, 189, 68, 190, 191, 192, 171, 11, 193, 76, 194, 195, 37, 196, 97, 197, 25, 198, 199, 97, 16, 33, 200, 201, 202, 203, 204, 205, 29, 206, 207, 31, 169, 208, 209, 210, 211, 68, 27, 212, 162, 213, 10, 52, 214, 215, 107, 216, 217, 218, 88, 219, 220, 21, 5, 40, 214, 221, 222, 223, 48, 69, 224, 225, 226, 227, 228, 229, 199, 230, 231, 232, 233, 2, 234, 235, 236, 237, 33, 238, 121, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 0, 171, 251, 252, 253, 224, 254, 21, 255, 256, 102, 257, 39, 54, 258, 259, 260, 261, 39, 183, 21, 95, 153, 262, 263, 73, 264, 265, 266, 237, 267, 2, 68, 175, 268, 76, 269, 270, 271, 272, 273, 274, 275, 35, 175, 276, 277, 278, 279, 280, 281, 282, 283, 284, 1, 285, 286, 47, 256, 287, 162, 288, 289, 290, 290, 291, 292, 139, 293, 294, 295, 296, 11, 297, 298, 299, 300, 256, 301, 239, 302, 303, 304, 305, 168, 306, 102, 307, 263, 77, 189, 73, 308, 9, 309, 147, 124, 310, 68, 311, 29, 312, 40, 68, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 251, 324, 325, 235, 2, 326, 327, 328, 23, 16, 164, 329, 330, 189, 59, 331, 332, 333, 0, 334, 68, 335, 336, 274, 256, 337, 338, 165, 115, 339, 115, 340, 0, 298, 341, 256, 342, 343, 344, 345, 273, 258, 346, 347, 238, 348, 349, 99, 173, 350, 351, 352, 332, 16, 353, 354, 355, 288, 356, 156, 357, 212, 358, 100, 359, 360, 303, 361, 4, 64, 362, 363, 126, 0, 364, 365, 366, 23, 367, 368, 237, 369, 370, 371, 357, 372, 373, 374, 29, 375, 376, 377, 378, 379, 52, 380, 381, 382, 273, 383, 384, 385, 386, 387, 388, 389, 100, 390, 391, 3, 392, 393, 394, 395, 182, 10, 245, 396, 397, 398, 55, 399, 400, 29, 401, 402, 403, 404, 19, 188, 405, 222, 406, 407, 408, 409, 410, 77, 411, 125, 352, 412, 413, 414, 415, 416, 417, 418, 364, 104, 411, 419, 61, 420, 421, 125, 422, 29, 175, 324, 26, 165, 423, 424, 425, 426, 427, 428, 429, 430, 71, 257, 171, 431, 432, 24, 433, 434, 435, 436, 68, 437, 438, 439, 146, 417, 403, 440, 441, 86, 261, 307, 296, 442, 443, 444, 445, 446, 447, 267, 448, 449, 450, 234, 451, 452, 354, 453, 73, 454, 95, 455, 456, 457, 89, 29, 171, 458, 1, 459, 460, 461, 462, 463, 464, 10, 465, 346, 466, 467, 468, 469, 326, 470, 231, 381, 471, 472, 473, 474, 475, 476, 87, 369, 477, 478, 479, 480, 105, 481, 482, 483, 484, 485, 109, 486, 218, 487, 488, 489, 68, 346, 168, 490, 491, 492, 493, 494, 495, 496, 497, 38, 498, 499, 266, 500, 501, 502, 38, 57, 1, 503, 504, 505, 506, 143, 507, 508, 428, 509, 311, 510, 511, 512, 124, 513, 514, 81, 515, 516, 223, 0, 151, 33, 517, 238, 196, 142, 198, 518, 519, 520, 521, 379, 522, 146, 523, 407, 524, 525, 526, 527, 528, 194, 29, 368, 99, 235, 68, 36, 171, 68, 200, 529, 530, 531, 532, 533, 534, 535, 34, 536, 537, 538, 326, 539, 73, 540, 541, 542, 231, 31, 543, 422, 544, 427, 545, 481, 546, 547, 548, 549, 550, 226, 195, 551, 552, 12, 553, 554, 485, 555, 556, 159, 557, 558, 559, 560, 215, 417, 163, 335, 561, 562, 33, 563, 564, 565, 10, 566, 127, 95, 305, 567, 568, 100, 569, 570, 571, 572, 573, 574, 575, 576, 577, 31, 578, 579, 481, 580, 233};
int _ST_VOZLISC = sizeof(_RAZREDI) / sizeof(_RAZREDI[0]);
#define  _ST_RAZREDOV (sizeof(_P) / sizeof(_P[0]))
Vozlisce* _I2V[_ST_RAZREDOV];
bool _POBRISAN[_M];

Vozlisce* _ustvari() {
    Vozlisce* zacetek = NULL;
    Vozlisce* prej = NULL;
    int zadnjiRazred = -1;

    for (int i = 0; i < _ST_VOZLISC; i++) {
        Vozlisce* v = calloc(1, sizeof(Vozlisce));
        int r = _RAZREDI[i];
        if (r > zadnjiRazred) {
            zadnjiRazred = r;
            v->p = malloc(sizeof(int));
            *v->p = _P[r];
            _I2V[r] = v;
        } else {
            v->p = _I2V[r]->p;
        }
        if (i == 0) {
            zacetek = v;
        } else {
            prej->naslednje = v;
        }
        prej = v;
    }
    return zacetek;
}

void _izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* w = v;
    while (w != NULL) {
        printf("%s%d", (w == v ? "" : ", "), *w->p);
        w = w->naslednje;
    }
    printf("]\n");
}

void _preveriIstovetnost(Vozlisce* v) {
    int i = 0;
    for (Vozlisce* w = v; w != NULL; w = w->naslednje) {
        printf("%d", w == _I2V[i]);
        i++;
    }
    printf("\n");
}

void _pocisti(Vozlisce* v) {
    if (v != NULL) {
        _pocisti(v->naslednje);
        int pp = *v->p;
        if (!_POBRISAN[pp]) {
            free(v->p);
            v->p = NULL;
            _POBRISAN[pp] = true;
        }
        free(v);
    }
}

int main() {
    Vozlisce* v = _ustvari();

    printf("Prej:\n");
    _izpisi(v);
    printf("\n");

    izlociDuplikate(v);

    printf("Potem:\n");
    _izpisi(v);
    printf("\n");

    printf("Istovetnost ohranjenih vozlisc:\n");
    _preveriIstovetnost(v);

    _pocisti(v);

    return 0;
}
