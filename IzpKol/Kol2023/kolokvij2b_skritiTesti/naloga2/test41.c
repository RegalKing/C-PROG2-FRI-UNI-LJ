#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>

#include "naloga2.h"

#define _M 10001
int _P[] = {8701, 7009, 5827, 7969, 7703, 2714, 6991, 1068, 2430, 8582, 2612, 2193, 9686, 1060, 8848, 9058, 7510, 1590, 4654, 6017, 9580, 9084, 1499, 3586, 1823, 4242, 5339, 3662, 340, 6962, 2244, 5622, 3467, 2322, 7318, 854, 6220, 7696, 8500, 3149, 4662, 6036, 1508, 5219, 7580, 7335, 7071, 8184, 3485, 3533, 1307, 7920, 486, 8179, 4332, 3765, 3303, 2540, 6053, 1467, 6967, 6222, 1098, 6238, 1589, 6428, 349, 8933, 3989, 555, 8456, 2855, 8150, 4666, 460, 245, 7960, 6940, 4275, 6419, 1991, 3930, 9908, 1057, 4871, 2699, 8313, 8467, 4414, 6552, 5979, 1005, 9328, 7896, 5505, 8200, 1775, 3907, 1054, 7981, 6920, 1582, 8868, 9001, 2766, 1014, 8670, 8206, 2131, 2454, 874, 6587, 4818, 3066, 1152, 2763, 5636, 1257, 8677, 8173, 6727, 3075, 24, 9507, 9495, 744, 2571, 4757, 6775, 7425, 7877, 4138, 6132, 5516, 5445, 5527, 4393, 4924, 3783, 9530, 651, 4032, 7780, 3365, 3839, 5071, 4177, 8160, 6502, 7874, 7237, 8510, 6793, 3589, 6578, 5616, 3943, 5403, 2990, 6667, 8412, 7908, 2203, 595, 4831, 3248, 5885, 6976, 6868, 6889, 768, 1206, 5076, 2781, 5138, 7864, 8110, 7165, 7933, 1252, 3515, 5136, 7536, 7850, 7106, 1998, 7749, 7972, 9633, 4197, 112, 605, 2206, 1378, 756, 5217, 237, 5080, 2825, 3312, 8788, 5787, 4702, 999, 4440, 1797, 9691, 4217, 1749, 6954, 4523, 4772, 5038, 2807, 1383, 7200, 3537, 5908, 2419, 5471, 1903, 9545, 1375, 5146, 9395, 2528, 3029, 7886, 8196, 1304, 6646, 1729, 9054, 3264, 7902, 911, 4151, 9243, 4358, 8559, 700, 1062, 4934, 6907, 9167, 3087, 1510, 5875, 8526, 4257, 2991, 4607, 6252, 89, 8260, 9773, 2675, 5860, 4679, 1326, 6963, 8996, 4141, 6138, 8563, 4466, 3403, 2094, 1237, 6309, 2854, 4016, 8475, 8854, 7779, 2870, 548, 4801, 2595, 9816, 2917, 2271, 7520, 2966, 9327, 7852, 4533, 8870, 3689, 8878, 1973, 3205, 1927, 7630, 9072, 1091, 5654, 6076, 8309, 2889, 3719, 4305, 3958, 2189, 7169, 7809, 9262, 3728, 414, 4920, 4265, 7552, 8158, 260, 5617, 3859, 5067, 1601, 2925, 9557, 4962, 8898, 820, 3457, 7368, 8116, 8601, 8985, 7817, 5706, 1567, 2396, 2529, 6131, 1534, 5564, 8235, 5399, 8794, 2650, 7641, 855, 7941, 9915, 8820, 9777, 3629, 8395, 3468, 8690, 8602, 3878, 9470, 43, 5225, 1223, 1244, 1045, 2768, 9254, 3477, 8410, 8084, 9654, 6146, 8610, 3545, 8892, 4168, 1505, 7529, 747, 7629, 1360, 6710, 9042, 5047, 7730, 1407, 8270, 2706, 6999, 3050, 3941, 7973, 3382, 6500, 161, 2520, 1229, 7387, 8814, 7759, 9524, 2873, 5529, 7036, 6112, 4215, 9287, 7354, 5156, 9308, 9227, 9070, 8282, 5052, 2390, 869, 6081, 6536, 5423, 6932, 8239, 23, 2119, 303, 2744, 4409, 7533, 3016, 7059, 5927, 7724, 1640, 2691, 6442, 4537, 691, 471, 5111, 7544, 9913, 4398, 7380, 7240, 6635, 5447, 7549, 929, 5267, 3127, 7898, 8639, 9053, 7642, 4516, 8464, 8897, 6900, 8864, 1828, 5430, 7344, 7099, 5251, 1619, 5941, 6771, 8136, 6239, 4445, 3361, 9191, 961, 8436, 6926, 1088, 2799, 171, 4083, 1866, 5, 581, 5068, 7388, 5440, 4860, 2260, 9089, 7708, 8760, 6939, 4153, 156, 926, 6604, 3837, 8409, 9556, 3187, 8995, 8483, 1069, 1101, 836, 1089, 9177, 2278, 2042, 5257, 7565, 9732, 5247, 6420, 412, 4204, 395, 1267, 534, 7447, 2752, 7722, 5044, 2491, 9352, 7408, 5846, 859, 338, 7151, 9079, 7849, 9525, 5961, 6384, 4826, 8704, 4020, 7631, 6540, 3302, 9847, 6209, 9430, 1277, 9151, 3970, 9613, 9320, 7500, 1554, 4600, 2399, 2517, 1303, 7011, 238, 179, 5358, 5575, 1773, 4916, 1301, 3492, 3867, 6445, 8909, 2114, 2179, 5397, 559, 1099, 781, 9924, 1226, 8927, 6649, 1747, 1951, 8585, 1023, 1282, 2751, 1270, 7409, 539, 7359, 3750, 8918, 2559, 5969, 6499, 2626, 1396, 5570, 184, 5587, 6031, 9103, 1249, 1597, 7386, 4368, 7952, 9102, 9968, 2382, 96, 483, 8465, 9000, 7711, 2451, 7004, 8066, 8031, 334, 1997, 7404, 5736, 1393, 7017, 6095, 7725, 4159, 3694, 9069, 1574, 1075, 7915, 9874, 519, 2041, 9208, 3972, 1402, 7290, 3366, 3434, 1449, 2592, 3236, 636, 1679, 7538, 3192, 9371, 5650, 5685, 5915, 8652, 8259, 2032, 9669, 1352, 9909, 8812, 4362, 327, 4554, 3655, 4700, 7540, 7943, 751, 4227, 9929, 2759, 8286, 7132, 7460, 9294, 7346, 8873, 584, 1503, 6759, 1757, 4581, 9856, 4606, 5644, 3576, 3906, 6801, 8832, 6605, 8497, 5168, 6486, 6028, 2100, 6406, 9964, 5057, 552, 8238, 5987, 2069, 6427, 5452, 6918, 8791, 8452, 9953, 4779, 5693, 5829, 5539, 724, 3506, 206, 2705, 3284, 9757, 5007, 6487, 1488, 2696, 5843, 4562, 163, 9249, 5182, 7130, 4465, 7026, 7816, 1774, 3095, 9555, 4472, 9365, 8040, 4755, 7401, 9575, 456, 8693, 1617, 9458, 4560, 3166, 686, 9563, 2093, 9279, 2673, 4354, 3500, 5646, 4811, 890, 1710, 3148, 8051, 8641, 348, 3915, 8686, 5195, 9500, 3178, 7573, 3766, 9543, 5338, 9793, 5470, 6758, 639, 2010, 4140, 5113, 4234, 4970, 1049, 2846, 1114, 4139, 9944, 8773, 7480, 7808, 3881, 8174, 9771, 2191, 3345, 1322, 8741, 1167, 5019, 29, 5975, 8815, 3706, 5117, 1982, 1418, 5635, 2061, 7085, 2369, 5109, 689, 6199, 2777, 8726, 3657, 1705, 5254, 9746, 437, 5292, 3072, 9636, 9165, 3685, 1932, 3323, 9821, 7179, 7315, 1289, 4485, 3140, 2762, 8573, 5790, 5552, 4731, 5949, 6539, 6820, 2480, 292, 5279, 3791, 5775, 2771, 1104, 2280, 2581, 2486, 2890, 126, 4505, 3070, 4131, 7789, 4753, 9772, 2658, 79, 8997, 8675, 7945, 672, 3841, 7476, 489, 1756, 7107, 7174, 4778, 7109, 8524, 6079, 976, 5710, 688, 7025, 9345, 9434, 6271, 2149, 5048, 883, 1913, 5201, 7012, 2857, 9401, 2398, 9143, 8938, 4715, 6411, 373, 8616, 1977, 4899, 7807, 2233, 6602, 2479, 7515, 6878, 5812, 3733, 4861, 9826, 7329, 9835, 8038, 9121, 5409, 7419, 9088, 5214, 7572, 850, 7796, 8645, 4979, 5073, 2953, 4018, 6464, 5312, 2422, 2435, 5943, 3969, 666, 9534, 6090, 3359, 392, 250, 7239, 379, 9452, 5188, 9230, 5550, 4144, 1364};
int _RAZREDI[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 2, 0, 0, 4, 0, 5, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 7, 8, 0, 0, 0, 9, 0, 0, 10, 0, 0, 0, 3, 0, 0, 0, 11, 0, 0, 0, 0, 3, 8, 1, 12, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 8, 0, 0, 13, 8, 14, 0, 0, 15, 0, 0, 0, 0, 16, 0, 0, 0, 2, 0, 0, 8, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 7, 14, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 18, 0, 16, 0, 10, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 13, 0, 20, 0, 8, 0, 0, 0, 0, 0, 21, 0, 0, 0, 0, 22, 0, 1, 3, 0, 0, 23, 13, 0, 0, 0, 0, 0, 24, 0, 0, 0, 25, 0, 0, 0, 7, 0, 0, 26, 0, 0, 14, 25, 27, 28, 0, 0, 0, 23, 0, 0, 29, 8, 0, 0, 3, 30, 31, 0, 11, 0, 0, 25, 32, 25, 0, 0, 0, 0, 0, 0, 0, 0, 27, 0, 33, 0, 34, 0, 0, 13, 0, 0, 7, 21, 23, 0, 35, 5, 0, 0, 5, 0, 4, 0, 0, 36, 22, 8, 0, 37, 0, 0, 0, 38, 0, 3, 0, 0, 0, 0, 39, 0, 0, 0, 40, 7, 7, 8, 6, 0, 25, 6, 0, 41, 3, 0, 42, 8, 19, 13, 3, 16, 23, 0, 0, 6, 0, 0, 3, 2, 0, 0, 0, 10, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 0, 43, 0, 0, 0, 0, 0, 0, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 44, 3, 25, 45, 0, 0, 46, 0, 47, 0, 0, 0, 21, 12, 0, 48, 0, 0, 0, 49, 0, 2, 0, 2, 19, 0, 0, 6, 0, 1, 0, 0, 0, 0, 0, 50, 0, 0, 0, 25, 0, 8, 51, 0, 52, 0, 0, 0, 0, 0, 0, 14, 0, 0, 0, 0, 0, 53, 0, 0, 1, 54, 0, 0, 0, 0, 0, 55, 39, 23, 56, 0, 0, 0, 0, 8, 0, 25, 0, 0, 0, 57, 0, 58, 59, 39, 0, 43, 0, 60, 0, 61, 0, 16, 0, 3, 0, 0, 0, 8, 0, 62, 63, 0, 64, 0, 65, 0, 66, 0, 0, 5, 0, 0, 0, 0, 0, 22, 16, 0, 67, 29, 0, 0, 6, 68, 0, 23, 2, 0, 0, 0, 57, 5, 0, 0, 69, 0, 70, 0, 71, 0, 54, 0, 2, 72, 0, 55, 8, 0, 0, 29, 18, 43, 0, 73, 0, 13, 0, 74, 0, 0, 53, 50, 0, 0, 12, 60, 0, 75, 0, 3, 57, 76, 0, 77, 78, 22, 0, 79, 0, 0, 11, 0, 13, 19, 0, 80, 60, 16, 30, 6, 0, 0, 0, 23, 0, 0, 3, 0, 0, 25, 0, 57, 0, 5, 0, 30, 0, 55, 81, 82, 4, 0, 33, 27, 25, 0, 83, 0, 46, 0, 0, 0, 3, 8, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 19, 3, 8, 0, 0, 44, 0, 0, 8, 0, 0, 4, 4, 0, 21, 25, 0, 0, 0, 84, 16, 85, 0, 0, 80, 11, 0, 86, 25, 87, 0, 0, 0, 88, 0, 26, 0, 3, 0, 0, 8, 0, 0, 0, 0, 16, 3, 0, 0, 0, 0, 0, 72, 0, 36, 13, 89, 0, 0, 0, 0, 8, 8, 0, 37, 40, 0, 0, 0, 90, 0, 0, 55, 0, 0, 0, 0, 91, 92, 4, 13, 8, 8, 32, 0, 0, 2, 0, 0, 93, 0, 0, 0, 0, 0, 23, 0, 0, 0, 4, 94, 31, 88, 66, 24, 0, 0, 95, 0, 0, 0, 11, 2, 23, 30, 0, 0, 0, 0, 0, 66, 3, 83, 33, 0, 16, 0, 23, 30, 2, 40, 0, 0, 30, 0, 0, 0, 0, 2, 96, 0, 97, 0, 0, 8, 33, 0, 0, 0, 0, 0, 0, 74, 8, 0, 0, 0, 86, 0, 0, 0, 72, 0, 39, 16, 3, 0, 0, 98, 99, 0, 0, 60, 0, 100, 53, 0, 23, 50, 0, 0, 0, 101, 0, 13, 102, 0, 0, 0, 29, 103, 104, 0, 0, 0, 49, 0, 3, 0, 39, 0, 0, 105, 0, 103, 0, 79, 106, 24, 0, 0, 107, 99, 0, 0, 0, 0, 61, 3, 0, 19, 0, 47, 0, 0, 78, 6, 0, 0, 108, 0, 2, 0, 0, 3, 22, 66, 0, 0, 0, 3, 3, 109, 0, 0, 71, 104, 3, 8, 0, 13, 3, 12, 0, 0, 86, 110, 61, 111, 0, 0, 112, 0, 0, 0, 0, 0, 0, 6, 113, 0, 0, 19, 0, 112, 14, 19, 0, 0, 114, 0, 0, 0, 43, 103, 0, 0, 0, 23, 0, 115, 0, 0, 0, 0, 0, 0, 0, 116, 0, 117, 0, 0, 11, 118, 0, 65, 0, 23, 88, 0, 0, 0, 98, 0, 0, 3, 119, 0, 0, 72, 120, 5, 0, 61, 37, 2, 121, 0, 0, 7, 12, 0, 0, 0, 0, 0, 0, 0, 0, 122, 0, 0, 123, 124, 78, 8, 0, 80, 0, 116, 2, 0, 79, 0};
int _ST_VOZLISC = sizeof(_RAZREDI) / sizeof(_RAZREDI[0]);
#define  _ST_RAZREDOV (sizeof(_P) / sizeof(_P[0]))
Vozlisce* _I2V[_ST_RAZREDOV];
bool _POBRISAN[_M];

Vozlisce* _ustvari() {
    Vozlisce* zacetek = NULL;
    Vozlisce* prej = NULL;
    int zadnjiRazred = -1;

    for (int i = 0; i < _ST_VOZLISC; i++) {
        Vozlisce* v = calloc(1, sizeof(Vozlisce));
        int r = _RAZREDI[i];
        if (r > zadnjiRazred) {
            zadnjiRazred = r;
            v->p = malloc(sizeof(int));
            *v->p = _P[r];
            _I2V[r] = v;
        } else {
            v->p = _I2V[r]->p;
        }
        if (i == 0) {
            zacetek = v;
        } else {
            prej->naslednje = v;
        }
        prej = v;
    }
    return zacetek;
}

void _izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* w = v;
    while (w != NULL) {
        printf("%s%d", (w == v ? "" : ", "), *w->p);
        w = w->naslednje;
    }
    printf("]\n");
}

void _preveriIstovetnost(Vozlisce* v) {
    int i = 0;
    for (Vozlisce* w = v; w != NULL; w = w->naslednje) {
        printf("%d", w == _I2V[i]);
        i++;
    }
    printf("\n");
}

void _pocisti(Vozlisce* v) {
    if (v != NULL) {
        _pocisti(v->naslednje);
        int pp = *v->p;
        if (!_POBRISAN[pp]) {
            free(v->p);
            v->p = NULL;
            _POBRISAN[pp] = true;
        }
        free(v);
    }
}

int main() {
    Vozlisce* v = _ustvari();

    printf("Prej:\n");
    _izpisi(v);
    printf("\n");

    izlociDuplikate(v);

    printf("Potem:\n");
    _izpisi(v);
    printf("\n");

    printf("Istovetnost ohranjenih vozlisc:\n");
    _preveriIstovetnost(v);

    _pocisti(v);

    return 0;
}
