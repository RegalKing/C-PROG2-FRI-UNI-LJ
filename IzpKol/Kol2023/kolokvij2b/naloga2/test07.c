#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>

#include "naloga2.h"

#define _M 10001
int _P[] = {6621, 9792, 6834, 8471, 6960, 5036, 8252, 8717, 5633, 4171, 4512, 519, 2129, 9470, 8824, 9986, 1396, 9606, 7102, 7495, 4515, 4122, 7870, 2563, 9116, 8257, 9907, 4204, 9211, 9425, 255, 793, 1941, 7098, 8232, 1202, 562, 5856, 2603, 5726, 7891, 3101, 3315, 5425, 8091, 3008, 6311, 2787, 9260, 9722, 3184, 1635, 6190, 1080, 7995, 3317, 9143, 3255, 3429, 6680, 4672, 6068, 6634, 1205, 2957, 9390, 8422, 6050, 4419, 500, 8404, 935, 7801, 415, 5826, 8113, 924, 2083, 4414, 9951, 7579, 1316, 3274, 4774, 2137, 5275, 9382, 3476, 1367, 2178, 6694, 9509, 9049, 1626, 1605, 1904, 2359, 6722, 1690, 3818, 591, 819, 5280, 8952, 2680, 7218, 7961, 7715, 9428, 8707, 8532, 4591, 6448, 662, 1695, 5907, 2340, 4505, 7440, 5044, 7112, 2576, 598, 9710, 1408, 3477, 9658, 3603, 8375, 7423, 6838, 3562, 4271, 3197, 6532, 1299, 5407, 6965, 7635, 2863, 2468, 3107, 3060, 7729, 7601, 6593, 1347, 5383, 490, 8433, 178, 559, 3465, 1323, 1451, 1271, 1654, 2309, 8028, 136, 6688, 8314, 6591, 222, 1130, 8590, 4357, 2561, 1446, 5620, 6285, 2166, 4730, 1880, 2233, 7758, 1222, 401, 4203, 9569, 333, 9010, 1843, 7607, 8631, 8043, 3418, 4884, 7421, 8750, 8228, 6747, 7217, 3745, 5005, 494, 1359, 9913, 2599, 385, 8479, 3692, 369, 7132, 7400, 4221, 3246, 5613, 8754, 9387, 658, 3725, 4648, 4584, 4859, 9240, 8150, 4045, 8337, 9546, 1677, 5978, 6951, 266, 2418, 8139, 1039, 229, 6092, 4932, 792, 8538, 1936, 1902, 7737, 6128, 150, 4280, 4297, 8489, 7906, 3071, 2023, 3652, 5557, 5479, 7146, 6822, 6236, 9924, 8209, 3531, 1236, 7681, 287, 4566, 69, 234, 232, 5786, 3210, 7269, 6918, 6860, 4100, 2944, 6047, 927, 6107, 9096, 7954, 7514, 3218, 6564, 4684, 4755, 8315, 4612, 9647, 6367, 4048, 2304, 1573, 954, 8006, 8864, 9075, 1823, 8925, 7327, 399, 7277, 7214, 6224, 8288, 7818, 6401, 4645, 5113, 1194, 6034, 9567, 3893, 3836, 9225, 9818, 6850, 8302, 6254, 9016, 4093, 2040, 1989, 9216, 1583, 4999, 19, 6045, 7416, 8042, 1803, 857, 393, 5899, 4732, 1808, 6754, 3876, 2935, 4087, 778, 1957, 9242, 1467, 121, 5864, 5133, 8874, 7652, 7442, 8679, 6885, 9610, 9086, 7285, 9252, 4342, 799, 5529, 612, 2501, 3666, 4877, 6156, 6148, 2970, 9807, 5185, 3979, 7147, 3335, 9357, 2846, 767, 8102, 6842, 9898, 1168, 1082, 3073, 358, 8196, 3220, 62, 5214, 3266, 6624, 9047, 2048, 2537, 480, 6185, 2024, 5680, 8554, 3209, 1111, 592, 6735, 6612, 16, 342, 1917, 7409, 7632, 458, 5610, 5405, 34, 4388, 3233, 8787, 1844, 9232, 6390, 2318, 7467, 8710, 1645, 8989, 8180, 9005, 4935, 703, 6477, 2958, 7335, 2007, 8491, 7473, 7634, 8713, 380, 681, 3282, 3432, 383, 4491, 7123, 1745, 8192, 3001, 4056, 3179, 1241, 7843, 9955, 1618, 977, 5889, 746, 6484, 670, 1788, 3834, 6520, 6572, 7603, 9618, 4181, 3763, 1423, 9637, 353, 2542, 6503, 4227, 7525, 133, 5426, 9999, 9695, 2907, 928, 6319, 3671, 6323, 2581, 3948, 1062, 6870, 7030, 9396, 5471, 8860, 9494, 7734, 4847, 9128, 8555, 2193, 123, 880, 2387, 4111, 6345, 7827, 33, 7258, 4198, 836, 1180, 1148, 5083, 7924, 4880, 4156, 1033, 6623, 9292, 3079, 8539, 6895, 9355, 9284, 2705, 8914, 7393, 3215, 1436, 4786, 6857, 8729, 4829, 5220, 542, 1888, 4112, 9141, 4233, 8996, 5784, 3300, 3827, 2133, 9365, 8094, 8480, 9950, 1391, 3219, 8406, 7306, 3960, 9475, 1860, 107, 9997, 3202, 7410, 5099, 8563, 1045, 8134, 3904, 6336, 1265, 4402, 572, 8301, 1702, 8237, 3518, 1630, 6633, 4152, 9048, 464, 4839, 890, 3362, 6826, 376, 7885, 2115, 7105, 1261, 4536, 7610, 9679, 1145, 9518, 7242, 6488, 72, 2045, 4258, 7381, 9244, 7999, 877, 7334, 5855, 4079, 682, 9882, 5490, 2993, 621, 8820, 5466, 4449, 430, 2032, 3570, 4767, 7787, 4849, 9150, 6257, 8149, 5050, 8201, 4259, 360, 9124, 4358, 9066, 9832, 5852, 9120, 5725, 8286, 5162, 2464, 8462, 4033, 4827, 7822, 3574, 8954, 3146, 6966, 2068, 8919, 389, 8693, 2092, 6957, 6666, 8490, 7501, 4193, 7225, 7133, 1157, 2961, 6729, 1056, 3895, 5679, 7267, 2018, 546, 5703, 4852, 4646, 409, 8641, 5107, 698, 593, 2445, 4744, 6057, 2865, 9395, 6785, 3295, 3075, 3801, 3824, 9170, 8062, 2058, 3593, 2880, 3247, 9087, 7919, 9583, 4088, 3307, 628, 4599, 4788, 3068, 6427, 9995, 6287, 5465, 5839, 580, 7950, 3473, 9812, 5765, 3412, 7367, 5049, 9763, 1593, 6070, 6698, 7691, 2064, 772, 4983, 9190, 5482, 712, 6562, 1639, 5249, 3056, 1164, 529, 9904, 4708, 1513, 6578, 1669, 9432, 4216, 5365, 4485, 6270, 7712, 7029, 3952, 530, 9830, 4283, 5644, 5227, 748, 6104, 3569, 416, 9405, 2540, 5921, 5376, 9840, 971, 1052, 1734, 9221, 6138, 7582, 1582, 596, 3180, 3747, 4337, 7642, 4187, 3054, 5359, 7288, 8336, 818, 8756, 4161, 9586, 9007, 3712, 8, 4348, 644, 6293, 788, 5740, 8748, 8245, 7436, 2832, 9992, 1905, 3849, 5068, 9696, 2388, 597, 330, 2376, 1603, 5634, 4967, 3114, 5333, 3397, 9594, 5397, 7106, 5315, 9153, 8076, 1998, 7878, 4460, 1846, 3118, 531, 6802, 8514, 9468, 9838, 8273, 3986, 2972, 114, 9042, 5569, 5575, 3667, 7178, 4061, 2240, 2012, 8202, 1251, 7075, 7051, 2749, 9043, 3216, 2604, 7474, 9914, 2835, 7676, 4442, 7807, 467, 6817, 5710, 2475, 3352, 2168, 3161, 4807, 8522, 8645, 1833, 2731, 906, 2808, 3805, 7881, 2489, 6954, 1350, 8338, 5858, 5149, 8830, 4526, 8248, 5318, 8478, 1163, 2727, 9644, 7955, 9592, 3539, 5228, 5617, 8166, 9781, 2321, 784, 9389, 6017, 8863, 4037, 2238, 5708, 7917, 1820, 765, 3411, 3994, 3675, 1856, 6909, 4316, 2591, 4129, 9803, 4964, 4903, 6438, 1193, 7309, 8723, 4261, 3681, 87, 3862, 1638, 2188, 239, 5016, 729, 6663, 3902, 486, 6527, 9173, 5021, 1760, 8010, 7684, 8354, 3756, 5056, 6759, 6360, 9886, 4524, 745, 6705, 3410, 1519, 7377, 5266, 6094, 2179, 9894, 678, 1886, 1801, 9678, 8720, 2743, 9939, 2945, 2095, 8877, 694, 137, 5197, 9084, 1937, 81, 4840, 3629, 6498, 8321, 7233, 2443, 5945, 736, 6021, 2500, 8859, 687, 9168, 3830, 6721, 5925};
int _RAZREDI[] = {0, 0, 0, 0, 0, 1, 0, 0, 2, 2, 0, 3, 4, 5, 0, 5, 6, 5, 7, 8, 9, 10, 11, 2, 0, 0, 0, 0, 12, 12, 13, 8, 14, 0, 2, 15, 0, 16, 5, 7, 0, 1, 1, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 5, 1, 22, 28, 5, 7, 0, 29, 30, 0, 22, 24, 31, 0, 7, 0, 32, 0, 33, 12, 9, 0, 34, 35, 35, 36, 37, 29, 21, 0, 38, 0, 39, 40, 41, 0, 12, 1, 42, 43, 22, 18, 17, 35, 44, 45, 39, 46, 1, 47, 48, 0, 28, 49, 35, 47, 50, 36, 15, 22, 51, 1, 36, 46, 26, 0, 0, 52, 16, 20, 53, 21, 35, 54, 6, 55, 24, 56, 57, 58, 16, 22, 59, 3, 60, 61, 39, 62, 63, 64, 61, 65, 47, 66, 0, 25, 67, 68, 69, 70, 71, 72, 33, 3, 68, 18, 39, 8, 50, 8, 53, 73, 36, 44, 55, 7, 12, 5, 0, 62, 74, 0, 7, 70, 75, 76, 77, 78, 24, 47, 79, 80, 81, 82, 83, 84, 8, 22, 85, 86, 87, 60, 8, 88, 4, 89, 90, 90, 91, 7, 92, 93, 94, 95, 96, 0, 74, 50, 44, 97, 98, 27, 60, 53, 80, 27, 23, 91, 3, 99, 62, 100, 101, 0, 38, 0, 30, 102, 16, 103, 39, 54, 60, 77, 104, 21, 105, 106, 107, 24, 76, 0, 73, 7, 108, 45, 109, 66, 76, 110, 0, 111, 112, 113, 79, 114, 67, 16, 115, 80, 116, 0, 76, 103, 117, 34, 118, 119, 120, 39, 22, 121, 0, 0, 122, 119, 3, 123, 44, 124, 7, 15, 125, 126, 50, 110, 127, 23, 128, 129, 0, 5, 60, 12, 130, 60, 60, 20, 131, 33, 132, 133, 39, 2, 119, 60, 134, 21, 135, 136, 15, 137, 138, 46, 0, 0, 119, 139, 140, 141, 17, 142, 143, 34, 144, 8, 2, 145, 48, 146, 21, 147, 0, 97, 85, 75, 148, 149, 31, 149, 0, 150, 151, 35, 5, 104, 47, 0, 152, 0, 153, 18, 154, 100, 58, 7, 96, 155, 69, 15, 24, 156, 157, 5, 158, 159, 160, 139, 50, 0, 161, 162, 163, 164, 0, 165, 33, 166, 167, 168, 169, 36, 152, 170, 35, 116, 137, 15, 47, 171, 172, 46, 162, 173, 174, 28, 175, 0, 109, 176, 177, 178, 179, 180, 181, 96, 182, 183, 184, 119, 45, 69, 185, 120, 69, 186, 168, 38, 187, 115, 39, 188, 0, 160, 16, 0, 189, 110, 100, 93, 94, 0, 34, 178, 73, 190, 191, 53, 104, 192, 193, 0, 2, 55, 21, 0, 122, 194, 38, 61, 195, 196, 21, 0, 13, 197, 198, 199, 50, 200, 6, 93, 15, 136, 0, 139, 10, 47, 44, 56, 152, 201, 29, 202, 0, 189, 203, 73, 204, 47, 49, 205, 24, 20, 5, 189, 206, 24, 107, 110, 207, 60, 208, 209, 210, 2, 211, 212, 0, 24, 80, 16, 1, 213, 0, 32, 36, 0, 76, 10, 214, 215, 216, 0, 0, 217, 218, 5, 219, 31, 220, 79, 16, 27, 221, 65, 36, 8, 222, 33, 171, 193, 45, 5, 68, 223, 118, 208, 8, 157, 224, 6, 60, 100, 45, 225, 39, 17, 10, 152, 5, 226, 227, 228, 229, 230, 22, 93, 0, 231, 107, 232, 0, 0, 0, 233, 97, 69, 0, 90, 234, 235, 54, 189, 236, 68, 237, 50, 238, 239, 76, 240, 241, 242, 63, 243, 244, 187, 245, 160, 246, 191, 247, 152, 248, 249, 250, 94, 251, 15, 0, 78, 202, 27, 252, 130, 34, 253, 254, 255, 256, 257, 258, 8, 259, 21, 36, 260, 34, 107, 261, 59, 262, 29, 263, 99, 100, 153, 261, 264, 265, 43, 39, 0, 152, 266, 76, 263, 207, 109, 267, 36, 268, 269, 52, 22, 55, 270, 271, 272, 76, 157, 273, 274, 275, 118, 276, 277, 138, 278, 40, 279, 280, 281, 282, 118, 283, 284, 285, 286, 287, 288, 216, 289, 192, 290, 74, 291, 292, 1, 293, 176, 210, 294, 0, 295, 296, 79, 48, 236, 94, 297, 298, 299, 234, 93, 300, 220, 275, 301, 302, 303, 157, 21, 304, 305, 306, 5, 307, 308, 0, 0, 16, 22, 309, 310, 311, 312, 313, 152, 314, 239, 144, 315, 316, 317, 187, 18, 240, 318, 38, 319, 81, 320, 321, 21, 322, 0, 323, 324, 325, 2, 326, 327, 328, 50, 79, 87, 183, 329, 5, 15, 93, 330, 0, 53, 331, 332, 0, 333, 0, 23, 82, 334, 280, 335, 336, 337, 338, 339, 38, 76, 153, 340, 341, 7, 342, 343, 2, 123, 344, 345, 346, 0, 347, 93, 94, 348, 349, 350, 0, 185, 18, 351, 352, 353, 80, 354, 8, 355, 191, 356, 94, 357, 20, 358, 1, 133, 122, 359, 360, 51, 361, 362, 0, 363, 231, 44, 364, 123, 255, 0, 365, 366, 94, 1, 47, 58, 101, 165, 273, 265, 180, 218, 367, 0, 273, 368, 314, 369, 143, 318, 370, 88, 50, 0, 310, 329, 371, 329, 299, 153, 372, 1, 122, 8, 373, 374, 375, 0, 23, 376, 103, 377, 134, 378, 379, 380, 381, 382, 383, 384, 305, 385, 386, 189, 387, 5, 115, 388, 25, 389, 390, 7, 391, 234, 332, 392, 393, 394, 118, 79, 36, 395, 335, 75, 0, 270, 0, 396, 397, 192, 398, 7, 399, 400, 401, 107, 156, 402, 403, 404, 80, 0, 7, 405, 185, 73, 406, 407, 408, 20, 409, 410, 64, 35, 0, 411, 412, 413, 414, 60, 415, 202, 416, 382, 417, 418, 285, 29, 419, 275, 126, 0, 420, 194, 111, 145, 43};
int _ST_VOZLISC = sizeof(_RAZREDI) / sizeof(_RAZREDI[0]);
#define  _ST_RAZREDOV (sizeof(_P) / sizeof(_P[0]))
Vozlisce* _I2V[_ST_RAZREDOV];
bool _POBRISAN[_M];

Vozlisce* _ustvari() {
    Vozlisce* zacetek = NULL;
    Vozlisce* prej = NULL;
    int zadnjiRazred = -1;

    for (int i = 0; i < _ST_VOZLISC; i++) {
        Vozlisce* v = calloc(1, sizeof(Vozlisce));
        int r = _RAZREDI[i];
        if (r > zadnjiRazred) {
            zadnjiRazred = r;
            v->p = malloc(sizeof(int));
            *v->p = _P[r];
            _I2V[r] = v;
        } else {
            v->p = _I2V[r]->p;
        }
        if (i == 0) {
            zacetek = v;
        } else {
            prej->naslednje = v;
        }
        prej = v;
    }
    return zacetek;
}

void _izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* w = v;
    while (w != NULL) {
        printf("%s%d", (w == v ? "" : ", "), *w->p);
        w = w->naslednje;
    }
    printf("]\n");
}

void _preveriIstovetnost(Vozlisce* v) {
    int i = 0;
    for (Vozlisce* w = v; w != NULL; w = w->naslednje) {
        printf("%d", w == _I2V[i]);
        i++;
    }
    printf("\n");
}

void _pocisti(Vozlisce* v) {
    if (v != NULL) {
        _pocisti(v->naslednje);
        int pp = *v->p;
        if (!_POBRISAN[pp]) {
            free(v->p);
            v->p = NULL;
            _POBRISAN[pp] = true;
        }
        free(v);
    }
}

int main() {
    Vozlisce* v = _ustvari();

    printf("Prej:\n");
    _izpisi(v);
    printf("\n");

    izlociDuplikate(v);

    printf("Potem:\n");
    _izpisi(v);
    printf("\n");

    printf("Istovetnost ohranjenih vozlisc:\n");
    _preveriIstovetnost(v);

    _pocisti(v);

    return 0;
}
